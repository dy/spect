const e=Symbol();class t{#e=[];constructor(e){this[0]=e}get value(){return this[0]}set value(t){this[0]=t;for(let s of this.#e)"function"==typeof s[e]&&s[e](),s.next&&(s[e]=s.next(t))}valueOf(){return this.value}toString(){return this.value}[Symbol.toPrimitive](e){return this.value}subscribe(t,s,i){const n=()=>(this.#e.length&&this.#e.splice(this.#e.indexOf(r)>>>0,1),i&&i()),r={next:t=t&&t.next||t,error:s=t&&t.error||s,complete:i=t&&t.complete||i,unsubscribe:n};return this.#e.push(r),void 0!==this[0]&&(r[e]=t(this[0])),n.unsubscribe=n}map(e){const s=new t;return this.subscribe((t=>s.value=e(t))),s}error(e){this.#e.map((t=>t.error&&t.error(e)))}[Symbol.observable||=Symbol.for("observable")](){return this}async*[Symbol.asyncIterator](){let e,t=[],s=new Promise((t=>e=t)),i=this.subscribe((i=>(t.push(i),e(),s=new Promise((t=>e=t)))));try{for(;;)yield*t.splice(0),await s}catch{}i()}dispose(){this[0]=null;const t=this.#e.map((t=>("function"==typeof t[e]&&t[e](),t.unsubscribe)));this.#e.length=0,t.map((e=>e()))}[Symbol.dispose||=Symbol("dispose")](){return this.dispose()}}let s=0,i={},n={},r={},l={},a={},o=new WeakMap,h="undefined"!=typeof AnimationEvent,c=document.head.appendChild(document.createElement("style"));function d(e,t,s){if(e&&e.raw)return new u(null,String.raw.apply(null,arguments));if("string"==typeof e)return new u(null,e,t);if(!t||"function"==typeof t){s=t;let i=e;i||(i=[]),i.nodeType&&(i=[i]);const n=new u(null,null,s);return i.forEach((e=>n.add(e))),n}return new u(e,t,s)}Symbol.dispose||=Symbol("dispose");class u extends Array{#t;#s;#i;#n;#r;#l;#a;#o;#h;constructor(e,o,d){if("number"==typeof e)return Array(e);if(super(),this.#t=new t(this),this.#s=new WeakMap,this.#i=new WeakSet,this.#n=new WeakMap,this.#r=e,this.#l=d,!o)return;const u=Object.getPrototypeOf(this);(e||document).querySelectorAll(o).forEach((e=>{u.add.call(this,e)}));const m=/(?:#([\w:-]+)|\[\s*name=['"]?([\w:-]+)['"]?\s*\]|\.([\w:-]+)|([\*\w:-]+))(\[[^\]]+\]|\.[\w:-]+)*$/;if(this.#a=o.split(/\s*,\s*/).map((e=>{const t=(e=new String(e)).match(m);if(e.filter=e,!t)return e;let[s,a,o,h,c,d]=t;return a?(i[e.id=a]=i[a]||[]).push(this):o?(l[e.name=o]=l[o]||[]).push(this):h?(n[e.class=h]=n[h]||[]).push(this):c&&(e.tag=c=c.toUpperCase(),r[c]=r[c]||[]).push(this),d?e.filter=e.slice(0,t.index)+e.slice(-d.length):t.index||delete e.filter,e})),this.#h=this.#a.some((e=>e.filter)),!h||!this.#a.every((e=>e.tag&&!e.filter))){let e=a[this.#a];if(!e){const{sheet:t}=c,{cssRules:i}=t;e=a[this.#a]=[],e.id="⬡-"+(s++).toString(36),t.insertRule(`@keyframes ${e.id}{}`,i.length),t.insertRule(`${this.#a.map((t=>t+`:not(.${e.id})`))}{animation:${e.id}}`,i.length),t.insertRule(`.${e.id}{animation:${e.id}}`,i.length),t.insertRule(`${this.#a.map((t=>t+`.${e.id}`))}{animation:unset;animation:revert}`,i.length),e.rules=[].slice.call(i,-4),e.onanim=t=>{if(t.animationName!==e.id)return;t.stopPropagation(),t.preventDefault();let{target:s}=t;s.classList.contains(e.id)?(s.classList.remove(e.id),e.forEach((e=>e.delete(s)))):(s.classList.add(e.id),e.forEach((e=>Object.getPrototypeOf(e).add.call(e,s,!1))))},document.addEventListener("animationstart",e.onanim,!0)}this.#o=e.id,e.push(this)}}add(e,t=this.#h){if(e&&!this.#s.has(e)&&(!t||e.matches(this.#a))){if(this.#r){if(this.#r===e)return;if(this.#r.nodeType){if(!this.#r.contains(e))return}else if([].every.call(this.#r,(t=>!t.contains(e))))return}this.push(e),this.#s.set(e,[e.id,e.name]),e.name&&(this[e.name]=e),e.id&&(this[e.id]=e),this.#i.has(e)&&this.#i.delete(e),o.has(e)&&o.get(e).has(this)||(o.has(e)||o.set(e,new Set),o.get(e).add(this),e.classList.add("⬡"),this.#n.set(e,this.#l?.(e)),this.#t.value=this)}}delete(e,t=!1){if(!this.#s.has(e))return;this.length&&this.splice(this.indexOf(e>>>0,1),1);const[s,i]=this.#s.get(e);i&&delete this[i],s&&delete this[s],this.#s.delete(e),this.#i.add(e);const n=()=>{if(!this.#i.has(e))return;if(this.#i.delete(e),!o.has(e))return;const t=this.#n.get(e);t&&(t.call?t(e):t.then&&t.then((e=>e&&e.call&&e()))),this.#n.delete(e),this.#t.value=this,o.get(e).delete(this),o.get(e).size||(o.delete(e),e.classList.remove("⬡"))};t?n():requestAnimationFrame(n)}[Symbol.observable||=Symbol.for("observable")](){return this.#t}item(e){return e<0?this[this.length+e]:this[e]}namedItem(e){return this[e]}has(e){return this.#s.has(e)}dispose(){if(this.#a&&this.#a.forEach((({id:e,class:t,name:s,tag:a})=>{e&&i[e].splice(i[e].indexOf(this)>>>0,1),s&&l[s].splice(l[s].indexOf(this)>>>0,1),t&&n[t].splice(n[t].indexOf(this)>>>0,1),a&&r[a].splice(r[a].indexOf(this)>>>0,1)})),this.#o){const e=a[this.#a];e.splice(e.indexOf(this)>>>0,1),e.length||(document.removeEventListener("animationstart",e.onanim),delete a[this.#a],e.rules&&e.rules.forEach((e=>{let t=[].indexOf.call(c.sheet.cssRules,e);~t&&c.sheet.deleteRule(t)})))}this.#t[Symbol.dispose]();let e=[...this];this.length=0,e.forEach((e=>this.delete(e,!0)))}[Symbol.dispose](){return this.dispose}}const m=(e,t,s)=>{t&&e&&[].forEach.call(e.nodeType?[e]:e,(e=>t.forEach((t=>Object.getPrototypeOf(t).add.call(t,e,s)))))},f=e=>[e.classList.contains("⬡")?e:null,...e.getElementsByClassName("⬡")].forEach((e=>o.has(e)&&o.get(e).forEach((t=>t.delete(e)))));new MutationObserver((e=>{for(let t of e){let{addedNodes:e,removedNodes:s,target:o}=t;if(!h){f(o);for(let e in a)m([o,...o.querySelectorAll(e)],a[e],!0)}s.forEach((e=>1===e.nodeType&&f(e))),e.forEach((e=>{if(1===e.nodeType){if(e.id&&(m(e,i[e.id]),e.getElementById))for(let t in i)m(e.getElementById(t),i[t]);if(e.name){m(e,l[e.name]);for(let t in l)m(e.getElementsByName(t),l[t])}if(e.className){e.classList.forEach((t=>m(e,n[t])));for(let t in n)m(e.getElementsByClassName(t),n[t])}m(e,r[e.tagName]);for(let t in r)m(e.getElementsByTagName(t),r[t])}}))}})).observe(document,{childList:!0,subtree:!0,attributes:!h});export{d as default};